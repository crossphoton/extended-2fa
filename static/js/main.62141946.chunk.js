(this["webpackJsonpextended-2fa"]=this["webpackJsonpextended-2fa"]||[]).push([[0],{149:function(e,t){},151:function(e,t){},162:function(e,t){},164:function(e,t){},191:function(e,t){},193:function(e,t){},194:function(e,t){},199:function(e,t){},201:function(e,t){},220:function(e,t){},232:function(e,t){},235:function(e,t){},261:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(28),a=(t=n.n(i),n(17)),c=n(282),o=n(279),l=n(280),s=n(2);function u(){return Object(s.jsx)(c.a,{position:"static",children:Object(s.jsx)(o.a,{children:Object(s.jsx)(l.a,{variant:"h6",children:"Extended 2FA"})})})}for(var d=n(281),h=n(72),j=function(e){var t=(a=e.details).secret,n=a.issuer,r=a.label,i=a.algorithm,a=(e=a.digits,a.step);return h.authenticator.options={step:a,digits:e,algorithm:i},t=h.authenticator.generate(t),Object(s.jsxs)("div",{className:"totp-card",style:{width:"90vw",margin:"30px 0px",display:"flex",justifyContent:"space-between",alignItems:"center",fontWeight:"900",fontSize:"30px",border:"1px solid black",padding:"10px"},children:[Object(s.jsxs)("div",{className:"left",children:[Object(s.jsx)("div",{className:"provider-name",children:n}),Object(s.jsx)("div",{className:"account-name",style:{fontWeight:"300",fontSize:"10px"},children:r})]}),Object(s.jsx)("div",{className:"code",style:{display:"flex",alignItems:"center"},children:Object(s.jsx)("div",{children:t})})]})},p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=new Uint8Array(256),g=0;g<p.length;g++)f[p.charCodeAt(g)]=g;var b=function(e){var t,n,r,i,a=.75*e.length,c=e.length,o=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);a=new ArrayBuffer(a);for(var l=new Uint8Array(a),s=0;s<c;s+=4)t=f[e.charCodeAt(s)],n=f[e.charCodeAt(s+1)],r=f[e.charCodeAt(s+2)],i=f[e.charCodeAt(s+3)],l[o++]=t<<2|n>>4,l[o++]=(15&n)<<4|r>>2,l[o++]=(3&r)<<6|63&i;return a},m=n(49);function x(e){var t=e.setAuthorized;return"false"===localStorage.getItem("fingerprint")?(setTimeout((function(){return t(!0)}),100),null):Object(s.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"60vh",margin:"100px 30px 30px 30px",alignItems:"center"},children:[Object(s.jsx)("p",{children:"Authorization required"}),Object(s.jsx)(d.a,{onClick:function(){navigator.credentials.preventSilentAccess(),navigator.credentials.create({publicKey:{authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"},challenge:b(Object(m.randomBytes)(16).toString("hex")),rp:{id:document.domain,name:"crossphoton inc."},user:{id:b(Object(m.randomBytes)(4).toString("hex")),name:"You",displayName:"You"},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}]}}).then((function(){return t(!0)})).catch((function(e){"NotAllowedError: The operation either timed out or was not allowed. See: https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.".toString()===e.toString()&&(t(!0),localStorage.setItem("fingerprint","false"))}))},variant:"contained",color:"secondary",children:"SCAN FINGERPRINT"})]})}function v(e){var t,n=e.showScanner,i=Object(r.useState)(!0),c=(u=Object(a.a)(i,2))[0],o=u[1],l=Object(r.useState)(!navigator.userAgentData.mobile),u=(e=(h=Object(a.a)(l,2))[0],i=h[1],function(){o(!c)}),h=(l=JSON.parse(localStorage.getItem("collection")),"No credentials found. "+(navigator.userAgentData.mobile?"Add some using the button below.":"Add them in your phone."));return null!=l&&(t=l.map((function(e,t){return Object(s.jsx)(j,{details:e},t)}))),setInterval(u,1e3),e?Object(s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[null==l?Object(s.jsx)("div",{style:{margin:100},children:h}):Object(s.jsx)("div",{children:t}),Object(s.jsxs)("div",{align:"center",children:[navigator.userAgentData.mobile&&Object(s.jsx)(d.a,{style:{margin:"10px"},variant:"contained",color:"primary",onClick:function(){return n(!0)},children:"ADD"}),Object(s.jsx)(d.a,{style:{margin:"10px"},onClick:u,variant:"contained",color:"primary",children:"Refresh"})]})]}):Object(s.jsx)(x,{authorized:e,setAuthorized:i})}var y={page:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}};function O(e){return e=e.showScanner,Object(s.jsx)("div",{style:y.page,children:Object(s.jsx)("div",{className:"main-content",children:Object(s.jsx)(v,{showScanner:e})})})}i=n(73);var S=n.n(i),w=n(129),A=n(130),C=n(74),N=n(131),I=function(e){if("string"!=typeof e||e.length<7)return null;var t=/otpauth:\/\/([A-Za-z]+)\/([^?]+)\??(.*)?/i.exec(e);if(!t||t.length<3)return null;var n=Object(a.a)(t,3),r=(n[0],n[1]);e=n[2];return r&&e?(n=(e=(n=decodeURIComponent(e)).split(/: ?/))&&2===e.length?{issuer:e[0],account:e[1]}:{issuer:"",account:n},t=t[3]?new URLSearchParams(t[3]):[],t=Object(N.a)(t).reduce((function(e,t){t=(n=Object(a.a)(t,2))[0];var n=n[1];return e[t]=n,e}),{}),{type:r.toLowerCase(),label:n,query:t}):null};function k(e){C.a.WORKER_PATH=A.a;var t,n=e.hideScanner;return Object(s.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(s.jsx)("video",{id:"scanner-video-element",style:{maxWidth:"100vw",maxHeight:"100vh",padding:"10px 10px"}}),Object(s.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-evenly"},children:[Object(s.jsx)(d.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){var e=document.getElementById("scanner-video-element");function r(){return(r=Object(w.a)(S.a.mark((function e(r){var i,a,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!(s=l=void 0),s={},o=I(o=r),s.secret=o.query.secret,s.issuer=o.query.issuer||o.label.issuer||"N/A",s.algorithm=o.query.algorithm||"sha1",s.digits=Number(o.query.digits)||6,s.step=Number(o.query.period)||30,s.label=o.label.account,s.algorithm=String(s.algorithm).toLowerCase(),null==s.secret&&(l=!1),null==(i=(l=null!=s.label&&l)?s:null)){e.next=6;break}t.stop(),n(!0),e.next=7;break;case 6:return e.abrupt("return");case 7:a=[],null==(c=JSON.parse(localStorage.getItem("collection")))?localStorage.setItem("collection",JSON.stringify(a)):a=c,a.push(i),localStorage.setItem("collection",JSON.stringify(a)),localStorage.setItem("toPush",!0);case 13:case"end":return e.stop()}var o,l,s}),e)})))).apply(this,arguments)}(t=new C.a(e,(function(e){return r.apply(this,arguments)}))).start()},children:"START"}),Object(s.jsx)(d.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){t&&t.stop(),n(!0)},children:"STOP"})]})]})}n=function(){var e=Object(r.useState)(!1),t=Object(a.a)(e,2),n=(e=t[0],t[1]);return e?Object(s.jsx)(k,{hideScanner:function(e){return n(!e)}}):Object(s.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(s.jsx)(u,{}),Object(s.jsx)(O,{showScanner:n})]})},t.a.render(Object(s.jsx)(n,{}),document.getElementById("root"))}},[[261,1,2]]]);