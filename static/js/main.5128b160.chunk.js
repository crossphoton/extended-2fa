(this["webpackJsonpextended-2fa"]=this["webpackJsonpextended-2fa"]||[]).push([[0],{182:function(e,t){},184:function(e,t){},194:function(e,t){},196:function(e,t){},223:function(e,t){},225:function(e,t){},226:function(e,t){},231:function(e,t){},233:function(e,t){},252:function(e,t){},264:function(e,t){},267:function(e,t){},296:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(14),c=n.n(a),o=n(16),s=n(333),l=n(334),u=n(335),d=n(298),h=n(337),j=n(336),p=n(66),b=n(340),f=n(332),g=n(300),x=n(331),m=n(339),v=n(144),O=n.n(v),y=n(145),S=n.n(y),w=n(3);var C=function(e){var t=e.onClose,n=e.open,r=e.supaClient,i=function(e){r.auth.signIn({provider:e},{redirectTo:window.location.origin})};return Object(w.jsxs)(m.a,{onClose:function(){t()},"aria-labelledby":"simple-dialog-title",open:n,children:[Object(w.jsx)(x.a,{id:"simple-dialog-title",children:"Choose Login method"}),Object(w.jsxs)(f.a,{children:[Object(w.jsx)(g.a,{onClick:function(){return i("google")},children:Object(w.jsx)(O.a,{})}),Object(w.jsx)(g.a,{onClick:function(){return i("github")},children:Object(w.jsx)(S.a,{})})]})]})},I=Object(s.a)((function(e){return{avatar:{backgroundColor:p.a[100],color:p.a[600]},root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function A(e){var t=I(),n=i.a.useState(!1),r=Object(o.a)(n,2),a=r[0],c=r[1],s=i.a.useState(!1),p=Object(o.a)(s,2),f=p[0],g=p[1],x=e.supaClient,m=x.auth.user();return Object(w.jsxs)(l.a,{position:"static",children:[Object(w.jsxs)(u.a,{children:[Object(w.jsx)(d.a,{variant:"h6",className:t.title,children:"Extended 2FA"}),a&&Object(w.jsxs)("div",{style:{display:"flex"},children:[Object(w.jsx)(j.a,{onClick:function(){x.auth.signOut(),c(!1)},children:"Logout"}),Object(w.jsx)("div",{children:Object(w.jsx)(h.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(w.jsx)(b.a,{alt:"Profile Picture",src:m.user_metadata.avatar_url})})})]}),!a&&Object(w.jsx)(j.a,{onClick:function(){g(!0)},children:"Login"}),Object(w.jsx)(C,{open:f,supaClient:x,onClose:function(){g(!1)}})]}),Object(w.jsx)("div",{style:{display:"none"},children:a?null:setTimeout((function(){(m=x.auth.user())&&c(!0)}),200)})]})}var N=n(154),k=n(338),T=n(90);for(var J=function(e){var t=e.details,n=t.secret,r=t.issuer,i=t.label,a=t.algorithm,c=t.digits,o=t.step;T.authenticator.options={step:o,digits:c,algorithm:a};var s=T.authenticator.generate(n);return Object(w.jsxs)("div",{className:"totp-card",style:{width:"90vw",margin:"30px 0px",display:"flex",justifyContent:"space-between",alignItems:"center",fontWeight:"900",fontSize:"30px",border:"1px solid black",padding:"10px"},children:[Object(w.jsxs)("div",{className:"left",children:[Object(w.jsx)("div",{className:"provider-name",children:r}),Object(w.jsx)("div",{className:"account-name",style:{fontWeight:"300",fontSize:"10px"},children:i})]}),Object(w.jsx)("div",{className:"code",style:{display:"flex",alignItems:"center"},children:Object(w.jsx)("div",{children:s})})]})},z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=new Uint8Array(256),P=0;P<z.length;P++)R[z.charCodeAt(P)]=P;var q=function(e){var t,n,r,i,a,c=.75*e.length,o=e.length,s=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var l=new ArrayBuffer(c),u=new Uint8Array(l);for(t=0;t<o;t+=4)n=R[e.charCodeAt(t)],r=R[e.charCodeAt(t+1)],i=R[e.charCodeAt(t+2)],a=R[e.charCodeAt(t+3)],u[s++]=n<<2|r>>4,u[s++]=(15&r)<<4|i>>2,u[s++]=(3&i)<<6|63&a;return l},D=n(63);var B=function(e){var t=e.setAuthorized;return"false"===localStorage.getItem("fingerprint")?(setTimeout((function(){return t(!0)}),100),null):Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"60vh",margin:"100px 30px 30px 30px",alignItems:"center"},children:[Object(w.jsx)("p",{children:"Authorization required"}),Object(w.jsx)(k.a,{onClick:function(){navigator.credentials.preventSilentAccess(),navigator.credentials.create({publicKey:{authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"},challenge:q(Object(D.randomBytes)(16).toString("hex")),rp:{id:document.domain,name:"crossphoton inc."},user:{id:q(Object(D.randomBytes)(4).toString("hex")),name:"You",displayName:"You"},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}]}}).then((function(){return t(!0)})).catch((function(e){"NotAllowedError: The operation either timed out or was not allowed. See: https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.".toString()===e.toString()&&(t(!0),localStorage.setItem("fingerprint","false"))}))},variant:"contained",color:"secondary",children:"SCAN FINGERPRINT"})]})};var E=function(e){var t,n=e.showScanner,i=Object(r.useState)(!0),a=Object(o.a)(i,2),c=a[0],s=a[1],l=Object(r.useState)(!navigator.userAgentData.mobile),u=Object(o.a)(l,2),d=u[0],h=u[1],j=function(){s(!c)},p=JSON.parse(localStorage.getItem("collection")),b="No credentials found. "+(navigator.userAgentData.mobile?"Add some using the button below.":"Add them in your phone.");return null!=p&&(t=p.map((function(e,t){return Object(w.jsx)(J,{details:e},t)}))),setInterval(j,1e3),d?Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[null==p?Object(w.jsx)("div",{style:{margin:100},children:b}):Object(w.jsx)("div",{children:t}),Object(w.jsxs)("div",{align:"center",children:[navigator.userAgentData.mobile&&Object(w.jsx)(k.a,{style:{margin:"10px"},variant:"contained",color:"primary",onClick:function(){return n(!0)},children:"ADD"}),Object(w.jsx)(k.a,{style:{margin:"10px"},onClick:j,variant:"contained",color:"primary",children:"Refresh"}),Object(w.jsx)(k.a,{style:{margin:"10px"},variant:"contained",color:"secondary",onClick:function(){var e=localStorage.getItem("supabase.auth.token");e?(e=JSON.parse(e).currentSession.access_token,window.confirm("Fetch from database?")&&fetch("/api/sync",{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){e&&localStorage.setItem("collection",JSON.stringify(e.secrets.data))}))):alert("User not logged in!!")},children:"Network Sync"})]})]}):Object(w.jsx)(B,{authorized:d,setAuthorized:h})},L={page:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}};var U=function(e){var t=e.showScanner;return Object(w.jsx)("div",{style:L.page,children:Object(w.jsx)("div",{className:"main-content",children:Object(w.jsx)(E,{showScanner:t})})})},F=n(2),H=n.n(F),M=n(151),W=n(152),Y=n(91),G=n(64);var K=function(e){if("string"!==typeof e||e.length<7)return null;var t=/otpauth:\/\/([A-Za-z]+)\/([^?]+)\??(.*)?/i.exec(e);if(!t||t.length<3)return null;var n=Object(o.a)(t,3),r=(n[0],n[1]),i=n[2];if(!r||!i)return null;var a=decodeURIComponent(i),c=a.split(/: ?/),s=c&&2===c.length?{issuer:c[0],account:c[1]}:{issuer:"",account:a},l=t[3]?new URLSearchParams(t[3]):[],u=Object(G.a)(l).reduce((function(e,t){var n=Object(o.a)(t,2),r=n[0],i=n[1];return e[r]=i,e}),{});return{type:r.toLowerCase(),label:s,query:u}};var _=function(e){Y.a.WORKER_PATH=W.a;var t,n=e.hideScanner;return Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(w.jsx)("video",{id:"scanner-video-element",style:{maxWidth:"100vw",maxHeight:"100vh",padding:"10px 10px"}}),Object(w.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-evenly"},children:[Object(w.jsx)(k.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){var e=document.getElementById("scanner-video-element");function r(e){var t=!0,n={},r=K(e);return n.secret=r.query.secret,n.issuer=r.query.issuer||r.label.issuer||"N/A",n.algorithm=r.query.algorithm||"sha1",n.digits=Number(r.query.digits)||6,n.step=Number(r.query.period)||30,n.label=r.label.account,n.algorithm=String(n.algorithm).toLowerCase(),null==n.secret&&(t=!1),null==n.label&&(t=!1),t?n:null}function i(){return(i=Object(M.a)(H.a.mark((function e(i){var a,c,o;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(a=r(i))){e.next=6;break}t.stop(),n(!0),e.next=7;break;case 6:return e.abrupt("return");case 7:c=[],null==(o=JSON.parse(localStorage.getItem("collection")))?localStorage.setItem("collection",JSON.stringify(c)):c=o,c.push(a),localStorage.setItem("collection",JSON.stringify(c)),localStorage.setItem("toPush",!0);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(t=new Y.a(e,(function(e){return i.apply(this,arguments)}))).start()},children:"START"}),Object(w.jsx)(k.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){t&&t.stop(),n(!0)},children:"STOP"})]})]})},Q=Object(N.a)("https://eowxmpvqnxlnzyxdmatv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyMTMzOTA1NSwiZXhwIjoxOTM2OTE1MDU1fQ.LAv9mB6v07KYl24NPeouLFSF06PAjaHQC8CvH7E4-gA");var V=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1];return n?Object(w.jsx)(_,{hideScanner:function(e){return i(!e)}}):Object(w.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(w.jsx)(A,{supaClient:Q}),Object(w.jsx)(U,{showScanner:i,supaClient:Q})]})};c.a.render(Object(w.jsx)(V,{}),document.getElementById("root"))}},[[296,1,2]]]);
//# sourceMappingURL=main.5128b160.chunk.js.map