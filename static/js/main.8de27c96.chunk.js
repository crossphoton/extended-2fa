(this["webpackJsonpextended-2fa"]=this["webpackJsonpextended-2fa"]||[]).push([[0],{182:function(e,t){},184:function(e,t){},195:function(e,t){},197:function(e,t){},224:function(e,t){},226:function(e,t){},227:function(e,t){},232:function(e,t){},234:function(e,t){},253:function(e,t){},265:function(e,t){},268:function(e,t){},297:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(14),c=n.n(r),o=n(16),s=(t=n(334),n(335)),l=n(336),u=n(299),d=n(338),h=n(337),j=n(66),p=n(341),b=n(333),f=n(301),g=n(332),x=n(340),m=(r=n(144),n.n(r)),O=(r=n(145),n.n(r)),v=n(3),y=function(e){function t(e){a.auth.signIn({provider:e},{redirectTo:window.location.origin})}var n=e.onClose,i=e.open,a=e.supaClient;return Object(v.jsxs)(x.a,{onClose:function(){n()},"aria-labelledby":"simple-dialog-title",open:i,children:[Object(v.jsx)(g.a,{id:"simple-dialog-title",children:"Choose Login method"}),Object(v.jsxs)(b.a,{children:[Object(v.jsx)(f.a,{onClick:function(){return t("google")},children:Object(v.jsx)(m.a,{})}),Object(v.jsx)(f.a,{onClick:function(){return t("github")},children:Object(v.jsx)(O.a,{})})]})]})},S=Object(t.a)((function(e){return{avatar:{backgroundColor:j.a[100],color:j.a[600]},root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function w(e){var t,n=S(),i=a.a.useState(!1),r=(t=Object(o.a)(i,2))[0],c=t[1],j=(i=a.a.useState(!1),i=(t=Object(o.a)(i,2))[0],t[1]),b=e.supaClient,f=b.auth.user();return Object(v.jsxs)(s.a,{position:"static",children:[Object(v.jsxs)(l.a,{children:[Object(v.jsx)(u.a,{variant:"h6",className:n.title,children:"Extended 2FA"}),r&&Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)(h.a,{onClick:function(){b.auth.signOut(),c(!1)},children:"Logout"}),Object(v.jsx)("div",{children:Object(v.jsx)(d.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(v.jsx)(p.a,{alt:"Profile Picture",src:f.user_metadata.avatar_url})})})]}),!r&&Object(v.jsx)(h.a,{onClick:function(){j(!0)},children:"Login"}),Object(v.jsx)(y,{open:i,supaClient:b,onClose:function(){j(!1)}})]}),Object(v.jsx)("div",{style:{display:"none"},children:r?null:setTimeout((function(){(f=b.auth.user())&&c(!0)}),200)})]})}r=n(154);for(var C=n(339),I=n(90),A=function(e){var t=(r=e.details).secret,n=r.issuer,i=r.label,a=r.algorithm,r=(e=r.digits,r.step);return I.authenticator.options={step:r,digits:e,algorithm:a},t=I.authenticator.generate(t),Object(v.jsxs)("div",{className:"totp-card",style:{width:"90vw",margin:"30px 0px",display:"flex",justifyContent:"space-between",alignItems:"center",fontWeight:"900",fontSize:"30px",border:"1px solid black",padding:"10px"},children:[Object(v.jsxs)("div",{className:"left",children:[Object(v.jsx)("div",{className:"provider-name",children:n}),Object(v.jsx)("div",{className:"account-name",style:{fontWeight:"300",fontSize:"10px"},children:i})]}),Object(v.jsx)("div",{className:"code",style:{display:"flex",alignItems:"center"},children:Object(v.jsx)("div",{children:t})})]})},N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=new Uint8Array(256),T=0;T<N.length;T++)k[N.charCodeAt(T)]=T;var J=function(e){var t,n,i,a,r=.75*e.length,c=e.length,o=0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);r=new ArrayBuffer(r);for(var s=new Uint8Array(r),l=0;l<c;l+=4)t=k[e.charCodeAt(l)],n=k[e.charCodeAt(l+1)],i=k[e.charCodeAt(l+2)],a=k[e.charCodeAt(l+3)],s[o++]=t<<2|n>>4,s[o++]=(15&n)<<4|i>>2,s[o++]=(3&i)<<6|63&a;return r},z=n(63);function R(e){var t=e.setAuthorized;return"false"===localStorage.getItem("fingerprint")?(setTimeout((function(){return t(!0)}),100),null):Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"60vh",margin:"100px 30px 30px 30px",alignItems:"center"},children:[Object(v.jsx)("p",{children:"Authorization required"}),Object(v.jsx)(C.a,{onClick:function(){navigator.credentials.preventSilentAccess(),navigator.credentials.create({publicKey:{authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"},challenge:J(Object(z.randomBytes)(16).toString("hex")),rp:{id:document.domain,name:"crossphoton inc."},user:{id:J(Object(z.randomBytes)(4).toString("hex")),name:"You",displayName:"You"},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}]}}).then((function(){return t(!0)})).catch((function(e){"NotAllowedError: The operation either timed out or was not allowed. See: https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.".toString()===e.toString()&&(t(!0),localStorage.setItem("fingerprint","false"))}))},variant:"contained",color:"secondary",children:"SCAN FINGERPRINT"})]})}function P(e){var t,n=e.showScanner,a=Object(i.useState)(!0),r=(l=Object(o.a)(a,2))[0],c=l[1],s=Object(i.useState)(!navigator.userAgentData.mobile),l=(e=(u=Object(o.a)(s,2))[0],a=u[1],function(){c(!r)}),u=(s=JSON.parse(localStorage.getItem("collection")),"No credentials found. "+(navigator.userAgentData.mobile?"Add some using the button below.":"Add them in your phone."));return null!=s&&(t=s.map((function(e,t){return Object(v.jsx)(A,{details:e},t)}))),setInterval(l,1e3),e?Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[null==s?Object(v.jsx)("div",{style:{margin:100},children:u}):Object(v.jsx)("div",{children:t}),Object(v.jsxs)("div",{align:"center",children:[navigator.userAgentData.mobile&&Object(v.jsx)(C.a,{style:{margin:"10px"},variant:"contained",color:"primary",onClick:function(){return n(!0)},children:"ADD"}),Object(v.jsx)(C.a,{style:{margin:"10px"},onClick:l,variant:"contained",color:"primary",children:"Refresh"}),Object(v.jsx)(C.a,{style:{margin:"10px"},variant:"contained",color:"secondary",onClick:function(){var e=localStorage.getItem("supabase.auth.token");e?(e=JSON.parse(e).currentSession.access_token,window.confirm("Fetch from database?")&&fetch("/api/sync",{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){e&&localStorage.setItem("collection",JSON.stringify(e.secrets.data))}))):alert("User not logged in!!")},children:"Network Sync"})]})]}):Object(v.jsx)(R,{authorized:e,setAuthorized:a})}var q={page:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}};function D(e){return e=e.showScanner,Object(v.jsx)("div",{style:q.page,children:Object(v.jsx)("div",{className:"main-content",children:Object(v.jsx)(P,{showScanner:e})})})}t=n(2);var B=n.n(t),E=n(151),L=n(152),U=n(91),F=n(64),H=function(e){if("string"!=typeof e||e.length<7)return null;var t=/otpauth:\/\/([A-Za-z]+)\/([^?]+)\??(.*)?/i.exec(e);if(!t||t.length<3)return null;var n=Object(o.a)(t,3),i=(n[0],n[1]);e=n[2];return i&&e?(n=(e=(n=decodeURIComponent(e)).split(/: ?/))&&2===e.length?{issuer:e[0],account:e[1]}:{issuer:"",account:n},t=t[3]?new URLSearchParams(t[3]):[],t=Object(F.a)(t).reduce((function(e,t){t=(n=Object(o.a)(t,2))[0];var n=n[1];return e[t]=n,e}),{}),{type:i.toLowerCase(),label:n,query:t}):null};function M(e){U.a.WORKER_PATH=L.a;var t,n=e.hideScanner;return Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("video",{id:"scanner-video-element",style:{maxWidth:"100vw",maxHeight:"100vh",padding:"10px 10px"}}),Object(v.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-evenly"},children:[Object(v.jsx)(C.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){var e=document.getElementById("scanner-video-element");function i(){return(i=Object(E.a)(B.a.mark((function e(i){var a,r,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=!(l=s=void 0),l={},o=H(o=i),l.secret=o.query.secret,l.issuer=o.query.issuer||o.label.issuer||"N/A",l.algorithm=o.query.algorithm||"sha1",l.digits=Number(o.query.digits)||6,l.step=Number(o.query.period)||30,l.label=o.label.account,l.algorithm=String(l.algorithm).toLowerCase(),null==l.secret&&(s=!1),null==(a=(s=null!=l.label&&s)?l:null)){e.next=6;break}t.stop(),n(!0),e.next=7;break;case 6:return e.abrupt("return");case 7:r=[],null==(c=JSON.parse(localStorage.getItem("collection")))?localStorage.setItem("collection",JSON.stringify(r)):r=c,r.push(a),localStorage.setItem("collection",JSON.stringify(r)),localStorage.setItem("toPush",!0);case 13:case"end":return e.stop()}var o,s,l}),e)})))).apply(this,arguments)}(t=new U.a(e,(function(e){return i.apply(this,arguments)}))).start()},children:"START"}),Object(v.jsx)(C.a,{style:{padding:"20 5"},variant:"outlined",onClick:function(){t&&t.stop(),n(!0)},children:"STOP"})]})]})}var W=Object(r.a)("https://eowxmpvqnxlnzyxdmatv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyMTMzOTA1NSwiZXhwIjoxOTM2OTE1MDU1fQ.LAv9mB6v07KYl24NPeouLFSF06PAjaHQC8CvH7E4-gA");r=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=(e=t[0],t[1]);return e?Object(v.jsx)(M,{hideScanner:function(e){return n(!e)}}):Object(v.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(v.jsx)(w,{supaClient:W}),Object(v.jsx)(D,{showScanner:n,supaClient:W})]})},c.a.render(Object(v.jsx)(r,{}),document.getElementById("root"))}},[[297,1,2]]]);