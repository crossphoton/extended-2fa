{"version":3,"sources":["components/navbar/loginDialog.js","components/navbar/navbar.js","components/base64tobuffer.js","components/totp/card.js","components/fingerprint.js","pages/totp-page.js","pages/page.js","components/parseUri.js","pages/qrScanner.js","App.js","index.js"],"names":["SimpleDialog","props","onClose","open","supaClient","handleLoginClick","provider","auth","signIn","redirectTo","window","location","origin","Dialog","aria-labelledby","DialogTitle","id","List","ListItem","onClick","useStyles","makeStyles","theme","avatar","backgroundColor","blue","color","root","flexGrow","menuButton","marginRight","spacing","title","MenuAppBar","classes","React","useState","setAuth","openLogin","setOpenLogin","user","AppBar","position","Toolbar","Typography","variant","className","style","display","MenuItem","signOut","IconButton","aria-label","aria-controls","aria-haspopup","Avatar","alt","src","user_metadata","avatar_url","setTimeout","card","details","secret","issuer","label","algorithm","digits","step","authenticator","options","totp","generate","width","margin","justifyContent","alignItems","fontWeight","fontSize","border","padding","chars","lookup","Uint8Array","i","length","charCodeAt","decode","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","len","p","arraybuffer","ArrayBuffer","bytes","FingerprintPage","setAuthorized","localStorage","getItem","flexDirection","minHeight","Button","navigator","credentials","preventSilentAccess","create","publicKey","authenticatorSelection","authenticatorAttachment","userVerification","challenge","randomBytes","toString","rp","document","domain","name","displayName","pubKeyCredParams","type","alg","then","catch","err","setItem","TOTPPage","cards","showScanner","value","setValue","userAgentData","mobile","handleRefresh","JSON","parse","noCredentialsText","map","d","index","setInterval","align","token","currentSession","access_token","confirm","fetch","headers","Authorization","res","json","data","stringify","secrets","alert","authorized","styles","page","height","pageRenderer","parseURI","uri","parts","exec","fullLabel","decodedLabel","decodeURIComponent","labelParts","split","account","qs","URLSearchParams","query","reduce","acc","key","toLowerCase","qrScanner","QrScanner","WORKER_PATH","QrScannerWorkerPath","hideScanner","maxWidth","maxHeight","videoElem","getElementById","verifyURL","url","valid","result","parsed","TOTPUriParser","Number","period","String","a","verify","stop","collection","current","push","start","createClient","App","showPicker","setShowPicker","bool","ReactDOM","render"],"mappings":"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","file":"static/js/main.5128b160.chunk.js","sourcesContent":["import List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport GoogleLoginButton from \"react-google-button\";\nimport GithubLoginButton from \"react-github-login-button\";\n\nfunction SimpleDialog(props) {\n  const { onClose, open, supaClient } = props;\n\n  const handleClose = () => {\n    onClose();\n  };\n\n  const handleLoginClick = (provider) => {\n    supaClient.auth.signIn(\n      { provider },\n      { redirectTo: window.location.origin }\n    );\n  };\n\n  return (\n    <Dialog\n      onClose={handleClose}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Choose Login method</DialogTitle>\n      <List>\n        <ListItem onClick={() => handleLoginClick(\"google\")}>\n          <GoogleLoginButton />\n        </ListItem>\n        <ListItem onClick={() => handleLoginClick(\"github\")}>\n          <GithubLoginButton />\n        </ListItem>\n      </List>\n    </Dialog>\n  );\n}\n\nexport default SimpleDialog;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { blue } from \"@material-ui/core/colors\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport SimpleDialog from \"./loginDialog\";\n\nconst useStyles = makeStyles((theme) => ({\n  avatar: {\n    backgroundColor: blue[100],\n    color: blue[600],\n  },\n  root: {\n    flexGrow: 1,\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  title: {\n    flexGrow: 1,\n  },\n}));\n\nexport default function MenuAppBar(props) {\n  const classes = useStyles();\n  const [auth, setAuth] = React.useState(false);\n  const [openLogin, setOpenLogin] = React.useState(false);\n\n  const { supaClient } = props;\n\n  var user = supaClient.auth.user();\n\n  const checkLogin = () => {\n    user = supaClient.auth.user();\n    if (user) {\n      setAuth(true);\n    }\n  };\n\n  const handleLogout = () => {\n    supaClient.auth.signOut();\n    setAuth(false);\n  };\n\n  const handleLogin = () => {\n    setOpenLogin(true);\n  };\n\n  const handleLoginDialogClose = () => {\n    setOpenLogin(false);\n  };\n\n  return (\n    <AppBar position=\"static\">\n      <Toolbar>\n        <Typography variant=\"h6\" className={classes.title}>\n          Extended 2FA\n        </Typography>\n        {auth && (\n          <div style={{ display: \"flex\" }}>\n            <MenuItem onClick={handleLogout}>Logout</MenuItem>\n            <div>\n              <IconButton\n                aria-label=\"account of current user\"\n                aria-controls=\"menu-appbar\"\n                aria-haspopup=\"true\"\n                color=\"inherit\"\n              >\n                <Avatar\n                  alt=\"Profile Picture\"\n                  src={user.user_metadata.avatar_url}\n                />\n              </IconButton>\n            </div>\n          </div>\n        )}\n\n        {!auth && <MenuItem onClick={handleLogin}>Login</MenuItem>}\n        <SimpleDialog\n          open={openLogin}\n          supaClient={supaClient}\n          onClose={handleLoginDialogClose}\n        />\n      </Toolbar>\n      <div style={{ display: \"none\" }}>\n        {!auth ? setTimeout(checkLogin, 200) : null}\n      </div>\n    </AppBar>\n  );\n}\n","var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n// Use a lookup table to find the index.\nvar lookup = new Uint8Array(256);\nfor (var i = 0; i < chars.length; i++) {\n  lookup[chars.charCodeAt(i)] = i;\n}\n\nfunction decode(base64) {\n  var bufferLength = base64.length * 0.75,\n    len = base64.length,\n    i,\n    p = 0,\n    encoded1,\n    encoded2,\n    encoded3,\n    encoded4;\n\n  if (base64[base64.length - 1] === \"=\") {\n    bufferLength--;\n    if (base64[base64.length - 2] === \"=\") {\n      bufferLength--;\n    }\n  }\n\n  var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n  for (i = 0; i < len; i += 4) {\n    encoded1 = lookup[base64.charCodeAt(i)];\n    encoded2 = lookup[base64.charCodeAt(i + 1)];\n    encoded3 = lookup[base64.charCodeAt(i + 2)];\n    encoded4 = lookup[base64.charCodeAt(i + 3)];\n\n    bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n    bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n    bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n  }\n\n  return arraybuffer;\n}\n\nexport default decode;\n","import { authenticator } from \"otplib\";\n\nfunction card(props) {\n  const { details } = props;\n  var { secret, issuer, label, algorithm, digits, step } = details;\n  authenticator.options = { step, digits, algorithm };\n\n  var totp = authenticator.generate(secret);\n\n  return (\n    <div\n      className=\"totp-card\"\n      style={{\n        width: \"90vw\",\n        margin: \"30px 0px\",\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        fontWeight: \"900\",\n        fontSize: \"30px\",\n        border: \"1px solid black\",\n        padding: \"10px\",\n      }}\n    >\n      <div className=\"left\">\n        <div className=\"provider-name\">{issuer}</div>\n        <div\n          className=\"account-name\"\n          style={{ fontWeight: \"300\", fontSize: \"10px\" }}\n        >\n          {label}\n        </div>\n      </div>\n      <div className=\"code\" style={{ display: \"flex\", alignItems: \"center\" }}>\n        {/* <div\n          className=\"totp-timer\"\n          style={{\n            fontWeight: 600,\n            borderRadius: \"50%\",\n            fontSize: 20,\n            marginRight: 20,\n            color: \"#276b94\",\n            padding: \"5px\",\n            border: \"1px solid #276b94\",\n          }}\n        >\n          20\n        </div> */}\n        <div>{totp}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default card;\n","import { Button } from \"@material-ui/core\";\nimport decode from \"./base64tobuffer\";\nimport { randomBytes } from \"crypto\";\n\nconst noFingerPrintError =\n  \"NotAllowedError: The operation either timed out or was not allowed. See: https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.\";\nfunction FingerprintPage(props) {\n  const { setAuthorized } = props;\n\n  if (localStorage.getItem(\"fingerprint\") === \"false\") {\n    setTimeout(() => setAuthorized(true), 100);\n    return null;\n  }\n\n  function fingerStart() {\n    navigator.credentials.preventSilentAccess();\n    navigator.credentials\n      .create({\n        publicKey: {\n          authenticatorSelection: {\n            authenticatorAttachment: \"platform\",\n            userVerification: \"required\",\n          },\n          challenge: decode(randomBytes(16).toString(\"hex\")),\n          rp: { id: document.domain, name: \"crossphoton inc.\" },\n          user: {\n            id: decode(randomBytes(4).toString(\"hex\")),\n            name: \"You\",\n            displayName: \"You\",\n          },\n          pubKeyCredParams: [\n            { type: \"public-key\", alg: -7 },\n            { type: \"public-key\", alg: -257 },\n          ],\n        },\n      })\n      .then(() => setAuthorized(true))\n      .catch((err) => {\n        if (noFingerPrintError.toString() === err.toString()) {\n          setAuthorized(true);\n          localStorage.setItem(\"fingerprint\", \"false\");\n        }\n      });\n  }\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"60vh\",\n        margin: \"100px 30px 30px 30px\",\n        alignItems: \"center\",\n      }}\n    >\n      <p>Authorization required</p>\n      <Button onClick={fingerStart} variant=\"contained\" color=\"secondary\">\n        SCAN FINGERPRINT\n      </Button>\n    </div>\n  );\n}\n\nexport default FingerprintPage;\n","import Button from \"@material-ui/core/Button\";\nimport TOTPCard from \"../components/totp/card\";\nimport Fingerprint from \"../components/fingerprint\";\nimport { useState } from \"react\";\n\nfunction TOTPPage(props) {\n  const { showScanner } = props;\n  const [value, setValue] = useState(true);\n\n  // function checkAuthorizationRequired() {}\n  const [auth, setAuth] = useState(!navigator.userAgentData.mobile);\n\n  function networkFetch() {\n    var token = localStorage.getItem(\"supabase.auth.token\");\n    if (token) {\n      token = JSON.parse(token).currentSession.access_token;\n      var consent = window.confirm(\"Fetch from database?\");\n      if (consent) {\n        fetch(\"/api/sync\", { headers: { Authorization: `Bearer ${token}` } })\n          .then((res) => res.json())\n          .then((data) => {\n            if (data)\n              localStorage.setItem(\n                \"collection\",\n                JSON.stringify(data.secrets.data)\n              );\n          });\n      }\n    } else {\n      alert(\"User not logged in!!\");\n    }\n  }\n\n  function getCredentials() {\n    var collection = JSON.parse(localStorage.getItem(\"collection\"));\n    return collection;\n  }\n  const handleRefresh = () => {\n    setValue(!value);\n  };\n\n  var credentials = getCredentials();\n\n  const noCredentialsText =\n    \"No credentials found. \" +\n    (navigator.userAgentData.mobile\n      ? \"Add some using the button below.\"\n      : \"Add them in your phone.\");\n\n  var cards;\n  if (credentials != null)\n    cards = credentials.map((d, index) => <TOTPCard key={index} details={d} />);\n\n  setInterval(handleRefresh, 1000);\n\n  return auth ? (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n      }}\n    >\n      {credentials == null ? (\n        <div style={{ margin: 100 }}>{noCredentialsText}</div>\n      ) : (\n        <div>{cards}</div>\n      )}\n      <div align=\"center\">\n        {navigator.userAgentData.mobile && (\n          <Button\n            style={{ margin: \"10px\" }}\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={() => showScanner(true)}\n          >\n            ADD\n          </Button>\n        )}\n        <Button\n          style={{ margin: \"10px\" }}\n          onClick={handleRefresh}\n          variant=\"contained\"\n          color=\"primary\"\n        >\n          Refresh\n        </Button>\n        <Button\n          style={{ margin: \"10px\" }}\n          variant=\"contained\"\n          color=\"secondary\"\n          onClick={networkFetch}\n        >\n          Network Sync\n        </Button>\n      </div>\n    </div>\n  ) : (\n    <Fingerprint authorized={auth} setAuthorized={setAuth} />\n  );\n}\n\nexport default TOTPPage;\n","import TOTPPage from \"./totp-page\";\n\nconst styles = {\n  page: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n};\n\nfunction pageRenderer(props) {\n  const { showScanner } = props;\n\n  // TODO: currently fingerprint not implemented (expected: server won't be needed)\n  function checkFingerprintAuth() {\n    // const value = sessionStorage.getItem(\"authenticated\");\n    return true;\n  }\n  return (\n    <div style={styles.page}>\n      {checkFingerprintAuth() ? (\n        <div className=\"main-content\">\n          <TOTPPage showScanner={showScanner} />\n        </div>\n      ) : (\n        <div>Login in first</div>\n      )}\n    </div>\n  );\n}\nexport default pageRenderer;\n","function parseURI(uri) {\n  // Quick sanity check\n  if (typeof uri !== \"string\" || uri.length < 7) return null;\n\n  // I would like to just use new URL(), but the behavior is different between node and browsers, so\n  // we have to do some of the work manually with regex.\n  const parts = /otpauth:\\/\\/([A-Za-z]+)\\/([^?]+)\\??(.*)?/i.exec(uri);\n\n  if (!parts || parts.length < 3) {\n    return null;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  const [fullUri, type, fullLabel] = parts;\n\n  // Sanity check type and label\n  if (!type || !fullLabel) {\n    return null;\n  }\n\n  // Parse the label\n  const decodedLabel = decodeURIComponent(fullLabel);\n\n  const labelParts = decodedLabel.split(/: ?/);\n\n  const label =\n    labelParts && labelParts.length === 2\n      ? { issuer: labelParts[0], account: labelParts[1] }\n      : { issuer: \"\", account: decodedLabel };\n\n  // Parse query string\n  const qs = parts[3] ? new URLSearchParams(parts[3]) : [];\n\n  const query = [...qs].reduce((acc, [key, value]) => {\n    acc[key] = value;\n\n    return acc;\n  }, {});\n\n  // Returned the parsed parts of the URI\n  return { type: type.toLowerCase(), label, query };\n}\n\nexport default parseURI;\n","/* eslint import/no-webpack-loader-syntax: off */\nimport QrScannerWorkerPath from \"file-loader!../../node_modules/qr-scanner/qr-scanner-worker.min.js\";\nimport QrScanner from \"qr-scanner\";\nimport TOTPUriParser from \"../components/parseUri\";\nimport Button from \"@material-ui/core/Button\";\n\nfunction qrScanner(props) {\n  QrScanner.WORKER_PATH = QrScannerWorkerPath;\n  const { hideScanner } = props;\n  var qrScanner;\n\n  function startScanner() {\n    const videoElem = document.getElementById(\"scanner-video-element\");\n    qrScanner = new QrScanner(videoElem, complete);\n\n    function verifyURL(url) {\n      var valid = true;\n      var result = {};\n      const parsed = TOTPUriParser(url);\n      result.secret = parsed.query.secret;\n      result.issuer = parsed.query.issuer || parsed.label.issuer || \"N/A\";\n      result.algorithm = parsed.query.algorithm || \"sha1\";\n      result.digits = Number(parsed.query.digits) || 6;\n      result.step = Number(parsed.query.period) || 30;\n      result.label = parsed.label.account;\n      result.algorithm = String(result.algorithm).toLowerCase();\n      if (result.secret == null) valid = false;\n      if (result.label == null) valid = false;\n      if (!valid) return null;\n      return result;\n    }\n\n    async function complete(result) {\n      const verify = verifyURL(result);\n      if (verify != null) {\n        qrScanner.stop();\n        hideScanner(true);\n      } else return;\n      var collection = [];\n      var current = JSON.parse(localStorage.getItem(\"collection\"));\n      if (current == null) {\n        localStorage.setItem(\"collection\", JSON.stringify(collection));\n      } else {\n        collection = current;\n      }\n\n      collection.push(verify);\n      localStorage.setItem(\"collection\", JSON.stringify(collection));\n      localStorage.setItem(\"toPush\", true);\n    }\n\n    qrScanner.start();\n  }\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <video\n        id=\"scanner-video-element\"\n        style={{ maxWidth: \"100vw\", maxHeight: \"100vh\", padding: \"10px 10px\" }}\n      />\n      <div\n        style={{\n          width: \"100%\",\n          display: \"flex\",\n          justifyContent: \"space-evenly\",\n        }}\n      >\n        <Button\n          style={{ padding: \"20 5\" }}\n          variant=\"outlined\"\n          onClick={startScanner}\n        >\n          START\n        </Button>\n        <Button\n          style={{ padding: \"20 5\" }}\n          variant=\"outlined\"\n          onClick={() => {\n            if (qrScanner) qrScanner.stop();\n            hideScanner(true);\n          }}\n        >\n          STOP\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default qrScanner;\n","import Navbar from \"./components/navbar/navbar\";\nimport { createClient } from \"@supabase/supabase-js\";\nimport Page from \"./pages/page\";\nimport ScannerPage from \"./pages/qrScanner\";\nimport { useState } from \"react\";\n\nconst supaClient = createClient(\n  \"https://eowxmpvqnxlnzyxdmatv.supabase.co\",\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyMTMzOTA1NSwiZXhwIjoxOTM2OTE1MDU1fQ.LAv9mB6v07KYl24NPeouLFSF06PAjaHQC8CvH7E4-gA\"\n);\n\nfunction App() {\n  const [showPicker, setShowPicker] = useState(false);\n  const hideScanner = (bool) => setShowPicker(!bool);\n\n  return showPicker ? (\n    <ScannerPage hideScanner={hideScanner} />\n  ) : (\n    <div style={{ width: \"100%\", height: \"100%\" }}>\n      <Navbar supaClient={supaClient} />\n      <Page showScanner={setShowPicker} supaClient={supaClient} />\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}